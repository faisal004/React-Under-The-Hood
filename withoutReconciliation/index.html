<!DOCTYPE html>
<html>
    <head>
        <title>Todo App</title>
        <style>
            .titleCell{
                font-weight: 400;
                font-size: large;
            }
            .delete-button {
              padding: 5px 10px;
              background-color: #f44336;
              color: white;
              border: none;
              cursor: pointer;
            }
          </style>

        <link rel="stylesheet" href="styles.css">

    </head>

    <body>
        <div id="main"
            style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 50vh;">
            <label for="titleInput"
                style="display: block; margin-bottom: 5px; font-weight: bold;">Title:</label>
            <input type="text" id="titleInput"
                style="width: 200px; padding: 5px; margin-bottom: 10px;">

            <label for="descriptionInput"
                style="display: block; margin-bottom: 5px; font-weight: bold;">Description:</label>
            <input type="text" id="descriptionInput"
                style="width: 200px; padding: 5px; margin-bottom: 10px;">

            <button onclick="postData()"
                style="padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer;">Send
                Data</button>
        </div>
       
        <table id="mainarea"
            style="display: flex; flex-direction: column; align-items: center;  height: 10vh; ">
           
        </table>
        <script>
            function postData() {
              const title = document.getElementById('titleInput').value;
              const description = document.getElementById('descriptionInput').value;
              const data = {
                title: title,
                description: description
              };
        
              fetch('http://localhost:3000/todos', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
              })
              .then(response => response.json())
              .then(responseData => {
                
                console.log(responseData);
                fetchData(); 
              })
              .catch(error => {
                
                console.error('Error:', error);
              });
            }
        
            function fetchData() {
              fetch('http://localhost:3000/todos', {
                method: 'GET',
              })
                .then(response => response.json())
                .then(data => {
               
                  console.log(data);
                  var parentElement = document.getElementById("mainarea");
                  parentElement.innerHTML = ''; 
        
                  for (var i = data.length-1; i >=0; i--) {
                    var row = document.createElement("tr");
                   
                    var idCell = document.createElement("td");
                    idCell.innerHTML = data[i].id;
                    var titleCell = document.createElement("td");
                    
                    titleCell.innerHTML = data[i].title;
                    titleCell.setAttribute("class","titleCell")
                    var descriptionCell = document.createElement("td");
                    descriptionCell.innerHTML = data[i].description;
                    var deleteButtonCell = document.createElement("td");
                    var deleteButton = document.createElement("button");
                    deleteButton.innerHTML = "Delete";
                    deleteButton.setAttribute("onclick","deleteTodo("+data[i].id+")")
                    deleteButton.setAttribute("class", "delete-button");
                    deleteButtonCell.appendChild(deleteButton);
        
                    row.appendChild(idCell);
                    row.appendChild(titleCell);
                    row.appendChild(descriptionCell);
                    row.appendChild(deleteButtonCell);
                    parentElement.appendChild(row);
                  }
                })
                .catch(error => {
                  console.error('Error:', error);
                });
            }
        
            function deleteTodo(id) {
              fetch('http://localhost:3000/todos/' + id, {
                method: 'DELETE',
              })
                .then(response => response.json())
                .then(responseData => {
                  console.log(responseData);
                  fetchData(); 
                })
                .catch(error => {
                  console.error('Error:', error);
                });
            }
        
            fetchData();
          </script>
    </body>
</html>
